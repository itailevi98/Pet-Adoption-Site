{"ast":null,"code":"var _jsxFileName = \"/Users/itailevi/Documents/ITC/Pet Adoption Site/client/src/context/AuthContext.jsx\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport { createContext, useState, useEffect, useContext } from \"react\";\nimport localforage from \"localforage\";\nimport { getUserById } from \"../lib/userApi\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const AuthContext = /*#__PURE__*/createContext({\n  token: null,\n  login: token => {},\n  logout: () => {},\n  isInitiallyLoaded: false,\n  user: null\n});\nexport const useAuth = () => {\n  _s();\n\n  return useContext(AuthContext);\n};\n\n_s(useAuth, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\n\nfunction AuthProvider(props) {\n  _s2();\n\n  const [isInitiallyLoaded, setIsInitiallyLoaded] = useState(false);\n  const [user, setUser] = useState(null);\n  const [token, setToken] = useState(null);\n\n  async function login(token) {\n    setToken(token);\n    await localforage.setItem(\"token\", token);\n    const {\n      first_name,\n      last_name,\n      role\n    } = await getUserById(token);\n    setUser({\n      first_name,\n      last_name,\n      role\n    });\n    await localforage.setItem(\"user\", {\n      first_name,\n      last_name,\n      role\n    });\n  }\n\n  async function logout() {\n    setToken(null);\n    setUser(null);\n    await localforage.removeItem(\"token\");\n    await localforage.removeItem(\"user\");\n  }\n\n  useEffect(() => {\n    async function getToken() {\n      const token = await localforage.getItem(\"token\");\n\n      if (token) {\n        setToken(token);\n        const user = await localforage.getItem(\"user\");\n\n        if (user) {\n          setUser(user);\n        }\n      }\n\n      setIsInitiallyLoaded(true);\n    }\n\n    getToken();\n  }, []);\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: {\n      token,\n      login,\n      logout,\n      isInitiallyLoaded,\n      user\n    },\n    children: props.children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 58,\n    columnNumber: 9\n  }, this);\n}\n\n_s2(AuthProvider, \"pgDHizwR4G9Ie3EQzgm9dtV8HQQ=\");\n\n_c = AuthProvider;\nexport default AuthProvider;\n\nvar _c;\n\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"sources":["/Users/itailevi/Documents/ITC/Pet Adoption Site/client/src/context/AuthContext.jsx"],"names":["createContext","useState","useEffect","useContext","localforage","getUserById","AuthContext","token","login","logout","isInitiallyLoaded","user","useAuth","AuthProvider","props","setIsInitiallyLoaded","setUser","setToken","setItem","first_name","last_name","role","removeItem","getToken","getItem","children"],"mappings":";;;;AAAA,SAASA,aAAT,EAAwBC,QAAxB,EAAkCC,SAAlC,EAA6CC,UAA7C,QAA+D,OAA/D;AACA,OAAOC,WAAP,MAAwB,aAAxB;AACA,SAASC,WAAT,QAA4B,gBAA5B;;AAEA,OAAO,MAAMC,WAAW,gBAAGN,aAAa,CAAC;AACrCO,EAAAA,KAAK,EAAE,IAD8B;AAErCC,EAAAA,KAAK,EAAGD,KAAD,IAAW,CAAE,CAFiB;AAGrCE,EAAAA,MAAM,EAAE,MAAM,CAAE,CAHqB;AAIrCC,EAAAA,iBAAiB,EAAE,KAJkB;AAKrCC,EAAAA,IAAI,EAAE;AAL+B,CAAD,CAAjC;AAQP,OAAO,MAAMC,OAAO,GAAG,MAAM;AAAA;;AACzB,SAAOT,UAAU,CAACG,WAAD,CAAjB;AACH,CAFM;;GAAMM,O;;AAIb,SAASC,YAAT,CAAsBC,KAAtB,EAA6B;AAAA;;AACzB,QAAM,CAACJ,iBAAD,EAAoBK,oBAApB,IAA4Cd,QAAQ,CAAC,KAAD,CAA1D;AACA,QAAM,CAACU,IAAD,EAAOK,OAAP,IAAkBf,QAAQ,CAAC,IAAD,CAAhC;AACA,QAAM,CAACM,KAAD,EAAQU,QAAR,IAAoBhB,QAAQ,CAAC,IAAD,CAAlC;;AACA,iBAAeO,KAAf,CAAqBD,KAArB,EAA4B;AACxBU,IAAAA,QAAQ,CAACV,KAAD,CAAR;AACA,UAAMH,WAAW,CAACc,OAAZ,CAAoB,OAApB,EAA6BX,KAA7B,CAAN;AACA,UAAM;AAAEY,MAAAA,UAAF;AAAcC,MAAAA,SAAd;AAAyBC,MAAAA;AAAzB,QAAkC,MAAMhB,WAAW,CAACE,KAAD,CAAzD;AACAS,IAAAA,OAAO,CAAC;AAAEG,MAAAA,UAAF;AAAcC,MAAAA,SAAd;AAAyBC,MAAAA;AAAzB,KAAD,CAAP;AACA,UAAMjB,WAAW,CAACc,OAAZ,CAAoB,MAApB,EAA4B;AAC9BC,MAAAA,UAD8B;AAE9BC,MAAAA,SAF8B;AAG9BC,MAAAA;AAH8B,KAA5B,CAAN;AAKH;;AAED,iBAAeZ,MAAf,GAAwB;AACpBQ,IAAAA,QAAQ,CAAC,IAAD,CAAR;AACAD,IAAAA,OAAO,CAAC,IAAD,CAAP;AACA,UAAMZ,WAAW,CAACkB,UAAZ,CAAuB,OAAvB,CAAN;AACA,UAAMlB,WAAW,CAACkB,UAAZ,CAAuB,MAAvB,CAAN;AACH;;AAEDpB,EAAAA,SAAS,CAAC,MAAM;AACZ,mBAAeqB,QAAf,GAA0B;AACtB,YAAMhB,KAAK,GAAG,MAAMH,WAAW,CAACoB,OAAZ,CAAoB,OAApB,CAApB;;AACA,UAAIjB,KAAJ,EAAW;AACPU,QAAAA,QAAQ,CAACV,KAAD,CAAR;AACA,cAAMI,IAAI,GAAG,MAAMP,WAAW,CAACoB,OAAZ,CAAoB,MAApB,CAAnB;;AACA,YAAIb,IAAJ,EAAU;AACNK,UAAAA,OAAO,CAACL,IAAD,CAAP;AACH;AACJ;;AAEDI,MAAAA,oBAAoB,CAAC,IAAD,CAApB;AACH;;AACDQ,IAAAA,QAAQ;AAEX,GAfQ,EAeN,EAfM,CAAT;AAiBA,sBACI,QAAC,WAAD,CAAa,QAAb;AAAsB,IAAA,KAAK,EAAE;AACzBhB,MAAAA,KADyB;AAEzBC,MAAAA,KAFyB;AAGzBC,MAAAA,MAHyB;AAIzBC,MAAAA,iBAJyB;AAKzBC,MAAAA;AALyB,KAA7B;AAAA,cAOKG,KAAK,CAACW;AAPX;AAAA;AAAA;AAAA;AAAA,UADJ;AAYH;;IApDQZ,Y;;KAAAA,Y;AAsDT,eAAeA,YAAf","sourcesContent":["import { createContext, useState, useEffect, useContext } from \"react\";\nimport localforage from \"localforage\";\nimport { getUserById } from \"../lib/userApi\";\n\nexport const AuthContext = createContext({\n    token: null,\n    login: (token) => {},\n    logout: () => {},\n    isInitiallyLoaded: false,\n    user: null\n});\n\nexport const useAuth = () => {\n    return useContext(AuthContext);\n}\n\nfunction AuthProvider(props) {\n    const [isInitiallyLoaded, setIsInitiallyLoaded] = useState(false);\n    const [user, setUser] = useState(null);\n    const [token, setToken] = useState(null);\n    async function login(token) {\n        setToken(token);\n        await localforage.setItem(\"token\", token);\n        const { first_name, last_name, role } = await getUserById(token);\n        setUser({ first_name, last_name, role });\n        await localforage.setItem(\"user\", {\n            first_name,\n            last_name,\n            role\n        });\n    }\n\n    async function logout() {\n        setToken(null);\n        setUser(null);\n        await localforage.removeItem(\"token\");\n        await localforage.removeItem(\"user\");\n    }\n\n    useEffect(() => {\n        async function getToken() {\n            const token = await localforage.getItem(\"token\");\n            if (token) {\n                setToken(token);\n                const user = await localforage.getItem(\"user\");\n                if (user) {\n                    setUser(user);\n                }\n            } \n            \n            setIsInitiallyLoaded(true);\n        }\n        getToken();\n        \n    }, []);\n\n    return (\n        <AuthContext.Provider value={{\n            token, \n            login,\n            logout,\n            isInitiallyLoaded,\n            user\n        }}>\n            {props.children}\n        </AuthContext.Provider>\n    )\n\n}\n\nexport default AuthProvider;\n"]},"metadata":{},"sourceType":"module"}